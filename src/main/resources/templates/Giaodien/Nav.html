<nav th:fragment="nav" class="navbar">
    <!-- Top black bar -->
    <div class="top-bar">
        <div class="nav-wrapper">
            <div class="top-left">
                <span th:text="${#dates.format(#dates.createNow(), 'EEEE, MMMM dd')}">Friday, February 05</span>
            </div>
            <div class="top-right">
               
                <!-- Login/User Menu -->
                <div th:if="${session.user}" class="user-menu">
                    <button class="user-button">
                        <i class="fas fa-user"></i>
                        <span th:text="${session.user.hoTen}">Người dùng</span>
                    </button>
                    <div class="user-dropdown">
                        <a href="/user/profile"><i class="fas fa-id-card"></i> Thông tin cá nhân</a>
                        <a href="/user/saved-posts"><i class="fas fa-bookmark"></i> Bài viết đã lưu</a>
                        <a href="/auth/logout"><i class="fas fa-sign-out-alt"></i> Đăng xuất</a>
                    </div>
                </div>
                <button th:unless="${session.user}" class="signin-btn">
                    <i class="fas fa-user"></i>
                    <span>Đăng nhập</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Main Header with Logo and Search -->
    <div class="header-main">
        <div class="nav-wrapper">
            <div class="logo-section">
                <a href="/" class="main-logo">
                    <h1>TIN<span class="highlight">TỨC</span></h1>
                </a>
            </div>
            <!-- Ad Banner Space -->
            <div class="header-banner">
                <img src="/images/banner-ad.jpg" alt="Advertisement">
            </div>
        </div>
    </div>

    <!-- Navigation Bar -->
    <div class="main-nav">
        <div class="nav-wrapper">
            <!-- Left Menu Toggle -->
            <div class="menu-left">
                <button class="menu-toggle" id="menu-toggle">
                    <i class="fas fa-bars"></i>
                </button>
                <!-- Side Menu -->
                <div class="side-menu" id="side-menu">
                    <button class="side-menu-close" id="side-menu-close">
                        <i class="fas fa-times"></i>
                    </button>
                    <ul>
                        <li><a href="/preferences"><i class="fas fa-heart"></i> Sở thích của tôi</a></li>
                        <li><a href="/lich-su-xem"><i class="fas fa-history"></i> Lịch sử đã xem</a></li>
                        <li class="admin-section" th:if="${session.user != null && (session.user.vaiTro == 'admin' || session.user.vaiTro == 'reporter')}">
                            <h3>Quản trị</h3>
                            <ul>
                                <li th:if="${session.user.vaiTro == 'admin'}">
                                    <a href="/admin/danhmuc"><i class="fas fa-folder"></i> Quản lý danh mục</a>
                                </li>
                                <li>
                                    <a href="/admin/baiviet">
                                        <i class="fas fa-newspaper"></i>
                                        <span th:text="${session.user.vaiTro == 'admin' ? 'Quản lý bài viết' : 'Bài viết của tôi'}"></span>
                                    </a>
                                </li>
                                <li th:if="${session.user.vaiTro == 'admin'}">
                                    <a href="/admin/nguoidung"><i class="fas fa-users"></i> Quản lý người dùng</a>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </div>
                <div class="menu-overlay" id="menu-overlay"></div>
            </div>

            <!-- Main Menu -->
            <ul class="main-menu">
                <li><a href="/">Tin tức</a></li>
                <li th:each="danhmuc : ${danhmucs}">
                    <a th:href="@{'/danh-muc/' + ${danhmuc.duongDan}}" 
                       th:text="${danhmuc.tenDanhMuc}">
                    </a>
                </li>
            </ul>
            </div>
        </div>
    </div>

    <!-- Auth Modal (giữ nguyên phần cũ) -->
    <div id="authModal" class="auth-modal">
        <div class="auth-modal-content">
            <span class="close-modal">&times;</span>
            
            <!-- Tab buttons -->
            <div class="auth-tabs">
                <button class="auth-tab-btn active" data-tab="login">Đăng nhập</button>
                <button class="auth-tab-btn" data-tab="register">Đăng ký</button>
            </div>

            <!-- Login Form -->
            <div id="loginForm" class="auth-form active">
                <form th:action="@{/auth/login}" method="post">
                    <div class="form-group">
                        <i class="fas fa-envelope"></i>
                        <input type="email" name="email" placeholder="Email" required>
                    </div>
                    <div class="form-group">
                        <i class="fas fa-lock"></i>
                        <input type="password" name="password" placeholder="Mật khẩu" required>
                    </div>
                    <div class="form-options">
                        <label><input type="checkbox" name="remember"> Ghi nhớ đăng nhập</label>
                    </div>
                    <button type="submit" class="auth-button">Đăng nhập</button>
                </form>
            </div>

            <!-- Register Form -->
            <div id="registerForm" class="auth-form">
                <form th:action="@{/auth/register}" method="post">
                    <div class="form-group">
                        <i class="fas fa-envelope"></i>
                        <input type="email" name="email" placeholder="Email" required>
                    </div>
                    <div class="form-group">
                        <i class="fas fa-user"></i>
                        <input type="text" name="hoTen" placeholder="Họ tên" required>
                    </div>
                    <div class="form-group">
                        <i class="fas fa-lock"></i>
                        <input type="password" name="matKhau" placeholder="Mật khẩu" required>
                    </div>
                    <div class="form-group">
                        <i class="fas fa-lock"></i>
                        <input type="password" name="xacNhanMatKhau" placeholder="Xác nhận mật khẩu" required>
                    </div>
                    <button type="submit" class="auth-button">Đăng ký</button>
                </form>
            </div>

            <!-- Verification Form -->
            <div id="verifyForm" class="auth-form">
                <form th:action="@{/auth/verify}" method="post">
                    <div class="form-group">
                        <i class="fas fa-key"></i>
                        <input type="text" name="code" placeholder="Nhập mã xác thực" required>
                    </div>
                    <button type="submit" class="auth-button">Xác thực</button>
                </form>
            </div>
        </div>
    </div>
</nav>

